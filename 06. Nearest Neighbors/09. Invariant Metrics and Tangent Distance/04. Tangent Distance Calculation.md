## Dist√¢ncia Tangente: Aproximando a Invari√¢ncia por meio de Espa√ßos Tangentes e Variedades

```mermaid
graph LR
    A["Input Data (e.g., images)"] --> B{"Transformations (e.g., rotations)"};
    B --> C["Manifold"];
    C --> D{"Tangent Space"};
    D --> E["Tangent Distance"];
    E --> F["Improved Classification"];
    style B fill:#f9f,stroke:#333,stroke-width:2px
    style D fill:#ccf,stroke:#333,stroke-width:2px
    style C fill:#cdf,stroke:#333,stroke-width:2px
```

### Introdu√ß√£o

Este cap√≠tulo explora a **dist√¢ncia tangente**, uma abordagem sofisticada para aproximar a **invari√¢ncia** a transforma√ß√µes em problemas de reconhecimento de padr√µes e classifica√ß√£o, especialmente √∫til em cen√°rios onde os dados podem apresentar rota√ß√µes, deforma√ß√µes, mudan√ßas de escala e outras transforma√ß√µes [^13.3.3]. A ideia central da dist√¢ncia tangente √© modelar a varia√ß√£o dos dados devido a essas transforma√ß√µes atrav√©s da utiliza√ß√£o de **espa√ßos tangentes** e **variedades**, e como essa abordagem permite que modelos de classifica√ß√£o, como o k-NN, capturem melhor a similaridade entre objetos que s√£o varia√ß√µes uns dos outros. Analisaremos como a dist√¢ncia tangente √© definida, calculada e aplicada em problemas de reconhecimento de caracteres manuscritos, demonstrando sua capacidade de lidar com transforma√ß√µes complexas e como ela se difere da dist√¢ncia Euclidiana e outras m√©tricas mais simples.

### Espa√ßos Tangentes e Variedades: Modelando a Varia√ß√£o dos Dados

A constru√ß√£o da **dist√¢ncia tangente** se baseia na modelagem das transforma√ß√µes que os dados podem sofrer utilizando conceitos da geometria diferencial, como **espa√ßos tangentes** e **variedades** [^13.3.3].

1.  **Variedades (Manifolds):** Uma variedade √© uma superf√≠cie, curva ou regi√£o no espa√ßo de *features* que representa um conjunto de objetos que s√£o transforma√ß√µes uns dos outros. Por exemplo, as rota√ß√µes de um d√≠gito manuscrito podem ser representadas como uma curva no espa√ßo de *features*, onde cada ponto da curva corresponde a uma rota√ß√£o diferente do d√≠gito. Essa curva √© chamada de *manifold* de rota√ß√£o. As transforma√ß√µes de um dado ponto s√£o assumidas como sendo uma variedade de baixa dimensionalidade no espa√ßo de *features* de alta dimensionalidade.

> üí° **Exemplo Num√©rico:**
> Imagine um d√≠gito "3" representado por um vetor de 256 pixels (uma imagem de 16x16 em tons de cinza). Se rotacionarmos este d√≠gito em incrementos de 1 grau, cada rota√ß√£o gera uma nova imagem, e cada imagem √© um ponto no espa√ßo de 256 dimens√µes. O conjunto dessas imagens rotacionadas forma uma curva (uma variedade) nesse espa√ßo. Essa variedade captura as varia√ß√µes do d√≠gito "3" devido √† rota√ß√£o.

2.  **Espa√ßos Tangentes:** Para cada ponto (objeto) no espa√ßo de *features*, √© definido um espa√ßo tangente que aproxima o *manifold* de transforma√ß√µes na vizinhan√ßa daquele ponto. O espa√ßo tangente √© um subespa√ßo linear que captura as dire√ß√µes nas quais a imagem se modifica com pequenas transforma√ß√µes (ex: vetores das derivadas). As linhas tangentes representam as poss√≠veis varia√ß√µes do objeto no espa√ßo de *features* por efeito de pequenas transforma√ß√µes.

```mermaid
graph LR
    subgraph "Manifold and Tangent Space"
    direction LR
        A["Manifold (e.g., Rotations)"]
        B["Point on Manifold (Object)"]
        C["Tangent Space at B"]
        D["Derivative Vectors"]
        A --> B
        B --> C
        C --> D
    end
```

> üí° **Exemplo Num√©rico:**
> Para o d√≠gito "3" do exemplo anterior, se pegarmos a imagem original e calcularmos a derivada (a taxa de varia√ß√£o) dos pixels quando o d√≠gito √© ligeiramente rotacionado, obteremos um vetor que aponta na dire√ß√£o em que a imagem muda devido √† rota√ß√£o. Esse vetor, e outros vetores calculados para outras transforma√ß√µes, formam a base do espa√ßo tangente naquele ponto (imagem do d√≠gito). Este espa√ßo tangente aproxima a variedade da rota√ß√£o localmente.

A defini√ß√£o de espa√ßos tangentes e variedades permite que a dist√¢ncia tangencial capture a similaridade entre objetos que s√£o transforma√ß√µes uns dos outros, e esses espa√ßos tangentes s√£o definidos por meio das derivadas, no ponto, de cada transforma√ß√£o.

**Lemma 128:** Espa√ßos tangentes s√£o aproxima√ß√µes lineares de variedades, que representam a varia√ß√£o dos dados por meio de transforma√ß√µes espec√≠ficas na vizinhan√ßa do ponto, e que servem de base para a constru√ß√£o da dist√¢ncia tangencial.
*Prova*: Os espa√ßos tangentes aproximam o *manifold* de transforma√ß√µes por um subespa√ßo linear que captura as dire√ß√µes de varia√ß√£o das transforma√ß√µes. $\blacksquare$

**Corol√°rio 128:** A dist√¢ncia tangencial entre dois objetos √© baseada na dist√¢ncia entre os seus espa√ßos tangentes, o que a torna invariante a pequenas transforma√ß√µes.

> ‚ö†Ô∏è **Nota Importante**: A dist√¢ncia tangencial utiliza espa√ßos tangentes e variedades para modelar as transforma√ß√µes que os objetos podem sofrer, e como esses espa√ßos representam a similaridade entre objetos transformados.

> ‚ùó **Ponto de Aten√ß√£o**:  A constru√ß√£o do *manifold* e do espa√ßo tangente envolve a defini√ß√£o das transforma√ß√µes e a deriva√ß√£o das suas derivadas, o que pode ser computacionalmente custoso.

### Constru√ß√£o da Dist√¢ncia Tangente: Proje√ß√£o e C√°lculo da Proximidade

A **constru√ß√£o da dist√¢ncia tangente** envolve os seguintes passos:

1.  **Defini√ß√£o das Transforma√ß√µes:** Definir as transforma√ß√µes que podem afetar os dados e que devem ser consideradas invariantes. No caso de d√≠gitos manuscritos, essas transforma√ß√µes podem incluir rota√ß√µes, transla√ß√µes, mudan√ßas de escala, cisalhamento (shearing) e varia√ß√µes na espessura.
2.  **C√°lculo do Espa√ßo Tangente:** Para cada objeto (imagem) e cada transforma√ß√£o, calcular as derivadas da imagem com rela√ß√£o ao par√¢metro da transforma√ß√£o, no ponto de opera√ß√£o. Essas derivadas correspondem ao espa√ßo tangente √† variedade da transforma√ß√£o. Por exemplo, para a rota√ß√£o de um d√≠gito, calcula-se a derivada da imagem em rela√ß√£o ao √¢ngulo de rota√ß√£o.

```mermaid
graph LR
    subgraph "Tangent Space Calculation"
    direction TB
        A["Object (x)"]
        B["Transformation (T)"]
        C["Derivative of T w.r.t. parameters"]
        D["Tangent Space (Tx)"]
        A --> B
        B --> C
        C --> D
    end
```

> üí° **Exemplo Num√©rico:**
> Suponha que a imagem de um d√≠gito "3" seja representada por um vetor $x \in \mathbb{R}^{256}$. Se a transforma√ß√£o de rota√ß√£o for dada por $R(\theta)$, onde $\theta$ √© o √¢ngulo de rota√ß√£o, a derivada da imagem em rela√ß√£o a $\theta$ (em $\theta=0$) √© dada por $\frac{\partial R(\theta)x}{\partial \theta}|_{\theta=0}$. Este vetor de derivadas √© um dos vetores que formam a base do espa√ßo tangente. Se tivermos outras transforma√ß√µes (transla√ß√£o, escala), calculamos derivadas para elas tamb√©m.

3.  **Proje√ß√£o nos Espa√ßos Tangentes:** Dado dois objetos a serem comparados, cada um √© projetado no espa√ßo tangente do outro.
4.  **C√°lculo da Dist√¢ncia:** A dist√¢ncia entre os objetos √© definida como a dist√¢ncia Euclidiana entre os objetos projetados nos espa√ßos tangentes. Essa dist√¢ncia √© calculada como a menor dist√¢ncia entre dois pontos, um em cada espa√ßo tangente. Essa proje√ß√£o busca o ponto no espa√ßo tangente de um objeto que √© mais similar ao outro objeto.

Em geral, a dist√¢ncia tangente √© calculada como:

$$d_{tangente}(x,y) = \min_{\alpha, \beta} || x + T_x \alpha - (y+T_y \beta) ||$$

Onde $x$ e $y$ s√£o dois objetos, $T_x$ e $T_y$ s√£o as bases dos espa√ßos tangentes de $x$ e $y$ respectivamente, e $\alpha$ e $\beta$ s√£o coeficientes de combina√ß√£o linear que minimizam a dist√¢ncia no espa√ßo de *features*.

```mermaid
graph LR
    subgraph "Tangent Distance Calculation"
    direction TB
        A["Object x"]
        B["Tangent Space Tx"]
        C["Object y"]
        D["Tangent Space Ty"]
        E["Projection of x onto Ty (x + Tx * alpha)"]
        F["Projection of y onto Tx (y + Ty * beta)"]
        G["Distance between E and F: "|| x + T_x*alpha - (y + T_y*beta) ||" "]
        A --> B
        C --> D
        A & B --> E
        C & D --> F
        E & F --> G
    end
```

> üí° **Exemplo Num√©rico:**
> Seja $x$ o vetor de pixels de uma imagem do d√≠gito "3" e $y$ o vetor de pixels de outra imagem do d√≠gito "3" ligeiramente rotacionada. Sejam $T_x$ e $T_y$ as matrizes que representam os espa√ßos tangentes de $x$ e $y$, respectivamente. Digamos que $T_x$ e $T_y$ sejam matrizes de 256x2, com as colunas representando as derivadas em rela√ß√£o √† rota√ß√£o e transla√ß√£o. Para encontrar a dist√¢ncia tangente, precisamos encontrar os coeficientes $\alpha = [\alpha_1, \alpha_2]^T$ e $\beta = [\beta_1, \beta_2]^T$ que minimizam a dist√¢ncia.
>
> Suponha que $x$ seja o vetor $[0.1, 0.2, \ldots, 0.9]$ (256 componentes), $y$ seja $[0.2, 0.1, \ldots, 0.8]$, $T_x$ seja uma matriz com as derivadas [deriv\_rot\_x, deriv\_trans\_x], e $T_y$ seja [deriv\_rot\_y, deriv\_trans\_y].
>
>  Calculamos $x + T_x \alpha$ e $y + T_y \beta$ para diferentes valores de $\alpha$ e $\beta$ e encontramos os valores que minimizam $|| x + T_x \alpha - (y+T_y \beta) ||$.
>
> Se encontrarmos, por exemplo, $\alpha = [0.01, -0.02]$ e $\beta = [0.03, 0.01]$, ent√£o a dist√¢ncia tangente ser√° $|| x + T_x [0.01, -0.02]^T - (y+T_y [0.03, 0.01]^T) ||$.
>
> Esta dist√¢ncia ser√° menor do que a dist√¢ncia euclidiana direta entre $x$ e $y$ se as transforma√ß√µes modeladas por $T_x$ e $T_y$ forem relevantes.

A aproxima√ß√£o por espa√ßos tangentes captura a informa√ß√£o da similaridade local e garante a invari√¢ncia a transforma√ß√µes, que √© capturada pela proje√ß√£o no espa√ßo tangente.

**Lemma 129:** A dist√¢ncia tangente √© definida como a menor dist√¢ncia entre um objeto e o espa√ßo tangente de outro, o que a torna invariante a pequenas transforma√ß√µes modeladas por tais espa√ßos tangentes.
*Prova*: A proje√ß√£o de um objeto no espa√ßo tangente de outro faz com que seja utilizada a m√≠nima dist√¢ncia entre as transforma√ß√µes do objeto projetado, que por defini√ß√£o √© invariante. $\blacksquare$

**Corol√°rio 129:** O c√°lculo da dist√¢ncia tangente envolve a estima√ß√£o de derivadas e a proje√ß√£o dos objetos em espa√ßos tangentes, o que aumenta a complexidade computacional da m√©trica.

> ‚ö†Ô∏è **Nota Importante**: A dist√¢ncia tangente √© constru√≠da por meio da proje√ß√£o dos objetos em seus espa√ßos tangentes, que capturam as varia√ß√µes devido a transforma√ß√µes.

> ‚ùó **Ponto de Aten√ß√£o**:  A defini√ß√£o e c√°lculo dos espa√ßos tangentes √© um passo complexo da aplica√ß√£o de dist√¢ncia tangente.

### Dist√¢ncia Tangente e k-NN: Melhorando a Robustez a Transforma√ß√µes

A aplica√ß√£o da **dist√¢ncia tangente** em conjunto com o algoritmo **k-vizinhos mais pr√≥ximos (k-NN)** permite melhorar a capacidade de generaliza√ß√£o do modelo e torn√°-lo mais robusto a transforma√ß√µes como rota√ß√µes, escalas e outras varia√ß√µes [^13.3.3]. Ao utilizar a dist√¢ncia tangente, o k-NN passa a selecionar os vizinhos mais pr√≥ximos com base na similaridade entre as formas dos objetos, e n√£o na sua representa√ß√£o posicional no espa√ßo de *features*.

```mermaid
graph LR
    subgraph "k-NN with Tangent Distance"
    direction TB
        A["Input Data with Transformations"]
        B["Tangent Distance Calculation"]
        C["k-NN Algorithm"]
        D["Robust Classification"]
        A --> B
        B --> C
        C --> D
    end
```

Com essa abordagem, o k-NN passa a ser capaz de classificar caracteres manuscritos mesmo que eles apresentem pequenas varia√ß√µes devido √†s transforma√ß√µes, o que melhora o desempenho do modelo em rela√ß√£o ao uso da dist√¢ncia Euclidiana. A dist√¢ncia tangente permite que o k-NN identifique vizinhos que s√£o realmente similares, mesmo que eles tenham sido transformados de formas que a dist√¢ncia euclidiana n√£o consegue identificar.

> üí° **Exemplo Num√©rico:**
> Imagine que temos um conjunto de dados de d√≠gitos manuscritos, alguns dos quais est√£o ligeiramente rotacionados. Se usarmos a dist√¢ncia euclidiana no k-NN, um "3" rotacionado pode ser considerado mais distante de um "3" n√£o rotacionado do que de um "8" n√£o rotacionado, pois os pixels ter√£o valores muito diferentes. No entanto, se usarmos a dist√¢ncia tangente, o "3" rotacionado ser√° considerado muito pr√≥ximo do "3" n√£o rotacionado, pois a dist√¢ncia tangente leva em conta a transforma√ß√£o de rota√ß√£o. Isso torna o k-NN mais robusto a varia√ß√µes nos dados.

A combina√ß√£o da flexibilidade do k-NN com o poder de m√©tricas invariantes, como a dist√¢ncia tangente, resulta em modelos de reconhecimento de padr√µes mais robustos e capazes de lidar com as varia√ß√µes que surgem em dados do mundo real.

**Lemma 130:** O uso da dist√¢ncia tangente no k-NN melhora a capacidade de generaliza√ß√£o do modelo e o torna mais robusto a transforma√ß√µes, pois a similaridade √© avaliada considerando as transforma√ß√µes que os objetos podem sofrer.
*Prova*: O uso de dist√¢ncias tangentes permite o reconhecimento de objetos mesmo com transforma√ß√µes, pois o que importa √© a similaridade estrutural e n√£o a similaridade posicional. $\blacksquare$

**Corol√°rio 130:** A combina√ß√£o de k-NN e dist√¢ncia tangente oferece um *tradeoff* entre complexidade e robustez, que pode ser vantajosa em problemas de reconhecimento de padr√µes com muitas transforma√ß√µes nos dados.

> ‚ö†Ô∏è **Nota Importante**: O uso da dist√¢ncia tangente no k-NN permite que o modelo se adapte a transforma√ß√µes que afetam os dados, o que melhora sua capacidade de generaliza√ß√£o e sua robustez a ru√≠dos.

> ‚ùó **Ponto de Aten√ß√£o**:  O c√°lculo da dist√¢ncia tangente pode ser computacionalmente custoso e sua implementa√ß√£o envolve a defini√ß√£o das transforma√ß√µes e o c√°lculo das derivadas, o que requer cuidado em sua aplica√ß√£o.

### Conclus√£o

A dist√¢ncia tangente √© uma abordagem poderosa para aproximar a invari√¢ncia a transforma√ß√µes como rota√ß√£o, escala e outras distor√ß√µes, e essa abordagem utiliza conceitos de espa√ßos tangentes e variedades para modelar as transforma√ß√µes, permitindo que o k-NN capture a similaridade entre objetos de forma mais eficaz do que a dist√¢ncia Euclidiana. A utiliza√ß√£o da dist√¢ncia tangente no k-NN resulta em modelos de reconhecimento de padr√µes mais robustos e com melhor capacidade de generaliza√ß√£o, que s√£o capazes de lidar com as varia√ß√µes que ocorrem naturalmente nos dados do mundo real. A escolha entre dist√¢ncia Euclidiana, dist√¢ncia tangente e outras m√©tricas de dist√¢ncia deve ser feita com base na natureza do problema e na necessidade de lidar com transforma√ß√µes espec√≠ficas.

### Footnotes

[^13.3.3]: "In some problems, the training features are invariant under certain natural transformations. The nearest-neighbor classifier can exploit such invariances by incorporating them into the metric used to measure the distances between objects...Hence we want our nearest-neighbor classifier to consider these two "3"s to be close together (similar). However the 256 grayscale pixel values for a rotated "3" will look quite different from those in the original image, and hence the two objects can be far apart in Euclidean distance in IR256...We wish to remove the effect of rotation in measuring distances between two digits of the same class. Consider the set of pixel values consisting of the original "3" and its rotated versions. This is a one-dimensional curve in IR256..." *(Trecho de "13. Prototype Methods and Nearest-Neighbors")*
